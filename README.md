# 단일판매, 공급계약체결 파이썬 크롤링 방법

## 관심 기업의 10년치 단일판매, 공급계약체결을 단 5분만에 정리할 수 있을까요?  

## 1. 설치 준비

> 이 부분은 파이썬을 처음 접하는 분을 위한 안내입니다. 평소 파이썬 프로그램을 사용하시는 분들은 패스하셔도 되겠습니다. 여기에서 소개하는 프로그램을 사용하기 위해 파이썬을 깊게 공부할 필요는 없으며, 아예 몰라도 가능합니다. 다만, 생소한 프로그램의 설치과정이 다소 복잡하고 어렵게 느껴질 수 있습니다. 그러나 쉽지만은 않더라도 설치만 완료하면 짜놓은 코드를 바로 사용할 수 있으니, 조금 힘들 수 있는 점은 감안하면서 차근차근 적용해 보시기를 권합니다. 프로그램을 설치 하면 거의 끝난 것과 다름이 없습니다.     

파이썬을 사용하기 위해서는 먼저 어떤 프로그램을 사용할지 정해야 합니다: 저는 파이썬, 스파이더 프로그램을 사용하였습니다. 

- Anaconda를 설치하면 파이썬과 Spyder(코딩 프로그램)가 함께 설치됩니다. 그러니 먼저 아나콘다 프로그램을 다운받아 주세요.
- 아나콘다 프로그램의 다운로드 링크는 다음과 같습니다.
- https://www.anaconda.com/products/distribution
※ 설치 방법이 어렵다면, 유튜브에 '아나콘다 설치 방법'을 검색해 보세요. 친절한 영상이 많습니다.

설치를 완료하면, Spyder 프로그램을 실행하거나 Anaconda Prompt를 이용해 필요한 라이브러리를 설치할 수 있습니다.


## 2. 필수 라이브러리 설치

이 프로그램을 실행하기 위해서는 몇 가지 라이브러리가 필요합니다.  
Anaconda Prompt를 실행한 후, 아래 명령어를 한 번에 복사하여 설치하세요:

### ▶ 어떻게 설치하나요?

1. '바탕화면 혹은 시작 메뉴 검색창'에서 `Anaconda Prompt`를 검색해 실행하세요.

2. 아래 명령어를 그림과 같이 복사해 붙여 넣습니다: 그리고 엔터를 눌러주세요. 그러면 자동으로 설치가 됩니다.  

pip install pandas requests keyring selenium openpyxl tqdm beautifulsoup4 
>
> 설치가 완료될 때까지 기다리세요.
이미 설치된 항목은 자동으로 건너뜁니다.
>
![image](https://github.com/user-attachments/assets/d43c0718-c7c1-4079-8976-139acd822ef7)


### ▶ 라이브러리별 개별 설치 명령어

라이브러리를 따로따로 설치하고 싶다면:
> pip install pandas
> pip install requests
> pip install keyring
> pip install selenium
> pip install openpyxl
> pip install tqdm
> pip install beautifulsoup4
> 설치 중 오류가 발생하면, 아래 개별 설치 명령어를 참고해서 설치하시기 바랍니다.

설치를 시작하면 완료될 때까지 기다려 주세요. 
설치 오류가 발생하면 해당 라이브러리만 따로 설치해도 됩니다.
※ 만약 pip install이 실패하면 conda install 명령어를 사용해도 됩니다.

※ 설치 방법이 어렵다면, 유튜브에 '라이브러리 설치 방법'을 검색해 보세요. 이 역시 친절한 영상이 많이 있습니다.

### 📦 설치되는 라이브러리 목록

- `pandas` – 표 형태 데이터 다루기
- `requests` – 인터넷 요청 처리 (API 호출)
- `keyring` – 비밀번호 안전 저장
- `selenium` – 웹 브라우저 자동화
- `openpyxl` – 엑셀 파일(.xlsx) 저장
- `tqdm` – 진행률 표시
- `beautifulsoup4` – HTML 분석 및 텍스트 추출- 

## 3. 편리한 API 키링(keyring) 설치

이 프로그램은 DART API 키와 같은 민감한 정보를 다룰 수 있습니다:  
이때 매번 코드에 비밀번호나 API 키를 직접 입력하면 보안에 취약하고, 실수로 유출될 위험도 있어요.

`keyring` 라이브러리를 사용하면 **한 번만 API 키를 저장해두고, 이후에는 자동으로 불러올 수 있어 편리하고 안전합니다.**

- 코드 공유 시 비밀번호/API 키 노출 없음
- 실행할 때마다 키 입력 불필요

> 아래 사진에서 라이브러리가 작성된 모습, 키링이 입력된 모습을 확인할 수 있습니다. 

![image](https://github.com/user-attachments/assets/9681d4dc-96a5-4eb3-8baf-3bad1ca1aa01)

## 4. 실행은 F9
여기에 업로드한 파이썬 프로그램을 실행할 때는 Cont+A를 눌러서 프로그램 전체를 선택하시고, F9을 눌러서 프로그램 전체를 한번에 실행시켜 주세요. 엔터가 아니라 F9! 
잘 안될 때에만 부분씩 실행해서 검토하시면 됩니다. 이제 카테고리로 돌아가서 키링을 만들고, 단일판매, 공급계약체결을 크롤링해 보세요. 


최종 출력된 결과는 아래와 같습니다. 보시는 바와 같이 계약금액과 계약기간_시작일은 출력이 되지 않네요. 초보라 수정이 생각만큼 만만치 않고, 주어진 단서를 이용해 수작업을 조금 거치면 아래 HD현대중공업의 사진에서와 같이 부족한 부분을 채울 수 있기에 우선은 이대로 공유합니다.   
어설퍼도 유용한 파이썬.  
> 예시, 한화에어로스페이스
![image](https://github.com/user-attachments/assets/4751cb82-9c6a-4df7-8d4f-bd5239b47c46)
> 예시, HD현대중공업
![image](https://github.com/user-attachments/assets/5888e35c-9da0-43cc-b6cd-39d432312030)

## 5. 추천 링크 
이해가 어렵거나 좀 더 공부해보고 싶으신 분께 추천합니다. 
https://github.com/hyunyulhenry/quant_py



https://www.youtube.com/watch?v=L0F3XwVwXzA&list=PLBcT2bWZuRNrSOu4vq8nM5eSWiN65-DvG


## 6. 실행 환경

본 프로그램이 설치된 운영체계는 아래와 같습니다.
- 혹 운영체계가 서로 맞지 않으면 실행이 되지 않을 수 있는데 그럴 때는 Chat GPT에 물어보면 해결방법을 안내해 줄테니 안심하고 실행해 보세요.

✅ 실행 환경 정보
- 운영체제: Windows 11

- 파이썬 버전: 3.12.4 (Anaconda 패키징)

- CPU 아키텍처: 64비트 (AMD64)

✅ 설치된 패키지 버전
- pandas==2.2.2

- requests==2.32.2

- keyring==24.3.1

- selenium==4.25.0

- openpyxl==3.1.2

- tqdm==4.66.4

- beautifulsoup4==4.12.3






